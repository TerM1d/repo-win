 Alarm Manager 2022
----------------------
## Описание
Alarm-manager - это демон, следящий за изменениями определенных параметров системы.
В зависимости от значений, сохраняются и выводятся индикации о выходе за
установленные пределы.
## Установка

Сначала обновите список пакетов:

```sh
sudo apt update
```

Теперь, для версии Ubuntu 20.04, чтобы установить [Qt Ubuntu](https://www.qt.io/download) выполните:

```sh
sudo apt install qt5-default
```

Если Ваша версия Ubuntu 21.04+, пропишите:

```sh
sudo apt install qtbase5-dev qtchooser qt5-qmake qtbase5-dev-tools
```

## Сборка и установка демона

Склонируйте проект в вашу рабочую директорию:

```sh
git clone http://study-git.eltex-co.ru/alarm-manager-nstu-2022-summer/alarm-manager-2022.git
```

Выполните сборку make в директории проекта:

```sh
make
```
Демон автоматически добавится в сервисы операционной системы, а рабочая директория с конфигурационным файлом скопируется в /home/$USER/alarm-manager-2022

## Работа с демоном
Команда для проверки работоспособности демона:
```sh
systemctl status AlarmPJ.service
```
Запустить демон:
```
systemctl start AlarmPJ.service
```
Остановить демон:
```
systemctl stop AlarmPJ.service
```
Команда для перезапуска демона:
```sh
systemctl restart AlarmPJ.service
```
Для работы с демоном необходимо заполнить конфигурационный файл config.conf (местоположение файла см. ниже):
### Заполнение конфигурационного файла

Название полей конфигурационного файла:

- **directoryName** - абсолютный путь нужной директории для мониторинга (**для этого поля необходимо прописать поле с данными limitUsedDirectory**);
- **limitUsedDirectory** - предел объёма для мониторинга нужной директории (**для этого поля необходимо прописать поле с данными directoryName**);
- **limitUsedRam** - предел объёма для используемой памяти ОЗУ;
- **limitUsedSwap** - предел объёма для занятого файла подкачки (swap);
- **limitFreeRam** - предел объёма для свободной памяти ОЗУ;

**Название полей (выделены жирным шрифтом) должно быть прописано со строгим соблюдением регистра!**

Для правильной работы демона заполнение конфигурационного файла производится так:
```
directoryName: путь/до/нужной/директории
limitUsedDirectory: объём Единицаобъёма
limitUsedRam: объём Единицаобъёма
limitUsedSwap: объём Единицаобъёма
limitFreeRam: объём Единицаобъёма
```
"Объём", - это число, "Единицаобъёма": **Kb**, **Mb**, **Gb**. 

Поля могут располагаться в любой последовательности.

Пример верного задания параметров конфигурационного файла config.conf для демона:
```
limitUsedDirectory: 1 Mb
directoryName: /home/max/projects
directoryName: /home/max/projects/alarm-manager-2022
limitUsedDirectory: 100 Kb
limitUsedRam: 4 Gb
limitUsedSwap: 450 Mb
limitFreeRam: 100 Mb
```
### Интерфейс взаимодействия пользователя с демоном alarmpj:

Запуск интрефейса:
```
alarmpj
```
В терминал выведется меню интерфейса с пунктами, где Вас просят ввести цифру для вывода в терминал по пункту меню: 
```sh
Меню взаимодействия с демоном AlarmPj:
1. Вывод текущих параметров конфигурации демона.
2. Вывод текущего лога.
3. Вывод имеющихся аварий (выход параметра за предел).
4. Очистка имеющихся аварий по запросу.
5. Вывод текущих параметров системы.
6. Выход.
Введите цифру пункта:
```
Введите цифру и нажмите на клавишу "Enter". Покажется информация по данному пункту и пропишется заново меню. Для выхода напишите ```6``` и нажмите на клавишу "Enter".
### Расположение текстовых файлов демона:
- /home/$USER/alarm-manager-2022/bin/config.conf - конфигурационный файл демона (находится внутри папки проекта);
- /var/tmp/configdir.txt - файл с путём расположения конфигурационного файла;
- /var/log/Logfile.log - файл логирования об ошибках демона и превышения допустимых лимитов (Alarm).
### Графическое окно alarmpj.
Появляется в случае, если элемент динамического массива **Alarmd** превышает значения по конфигурационному файлу config.conf и выводит строку: дата, текущее состояние системы и указанный пользователем предел.
**Нажмите в окне на кнопку "OK", чтобы закрыть данное окно.**
## Удаление:

Чтобы удалить демон необходимо, перейдя в директорию демона, прописать: 

```
make uninstall
```
или
```
make clean
```
